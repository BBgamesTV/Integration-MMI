<!DOCTYPE html>
<html lang="fr">
    <head>
        <title>Memory</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="./css/style.css" rel="stylesheet">
    </head>
    <body>
        <h1>Bastien Memory</h1>
        <h2>Score: </h2>
        <p id="score"></p>
        <div id="container" class="container"></div>
        <button onclick="newGame()">Recommencer</button>
        <script>
            const cards = ['♠️', '♣️', '♥️', '♦️','1','2','3','4'];
            const shuffledCards = cards.concat(cards).sort(() => 0.5 - Math.random());
            const scoreboard = document.getElementById('score');
            scoreboard.textContent = 0;
            
            let clicks = 0;

            let firstCard = null;
            let secondCard = null;
            let flippedCards = 0;
    
            const gameBoard = document.getElementById('container')
    
            shuffledCards.forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.classList.add('card');
                cardElement.textContent = card;
                cardElement.id=card;
                cardElement.addEventListener('click', () => flipCard(cardElement));
                gameBoard.appendChild(cardElement);
            });

            function flipCard(cardElement) {
                if (cardElement === firstCard) return;

                if (cardElement.classList.value === 'found') return;
                clicks++;
                scoreboard.textContent = clicks;



                cardElement.textContent = cardElement.textContent.trim();

                if (!firstCard || !secondCard) {
                    firstCard = firstCard || cardElement;
                    secondCard = cardElement === firstCard? null : cardElement;
                }

                firstCard.style.color= "white";
                secondCard.style.color= "white";

                if (firstCard && secondCard) {
                    const isMatch = firstCard.textContent === secondCard.textContent;
                    if (isMatch) {
                        flippedCards += 2;
                        console.log(firstCard.removeEventListener('click', flipCard));
                        console.log(secondCard.removeEventListener('click', flipCard));
                        firstCard.classList.add('found');
                        firstCard.classList.remove('card');
                        firstCard.onclick = null; 
                        secondCard.classList.add('found');
                        secondCard.classList.remove('card')
                        secondCard.onclick = null; 
                        firstCard = null;
                        secondCard = null;
                    } else {
                        setTimeout(() => {
                            firstCard.style.color= "#17191F";
                            secondCard.style.color= "#17191F";
                            firstCard = null;
                            secondCard = null;
                        },1500);
                    }
                }
            }

            function newGame() {
                location.reload();
            }
        </script>
    </body>
</html>